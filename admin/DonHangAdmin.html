<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lấy Thông Tin Đơn Hàng</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <style>
      body {
        background-color: #f8f9fa;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
      }
      .card {
        margin-bottom: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: none;
      }
      .card-body {
        background-color: #ffffff;
      }
      .table-responsive {
        max-height: 500px;
        overflow-y: auto;
      }
      .btn-primary {
        background-color: #ffb74d; /* Màu nút chính */
        border-color: #ffb74d;
        transition: background-color 0.3s, border-color 0.3s;
      }
      .btn-primary:hover {
        background-color: #ff9800; /* Màu nút khi hover */
        border-color: #ff9800;
      }
      .btn-export-excel {
        background-color: #66bb6a; /* Màu xanh cho nút Excel */
        border-color: #66bb6a;
        color: #fff;
        transition: background-color 0.3s;
      }
      .btn-export-excel:hover {
        background-color: #4caf50;
      }
      .btn-export-pdf {
        background-color: #ef5350; /* Màu đỏ cho nút PDF */
        border-color: #ef5350;
        color: #fff;
        transition: background-color 0.3s;
      }
      .btn-export-pdf:hover {
        background-color: #e53935;
      }
      .table thead th {
        cursor: pointer;
        position: relative;
        user-select: none;
      }
      .table thead th .fa-sort {
        margin-left: 5px;
        font-size: 0.8em;
        color: #6c757d;
        transition: transform 0.2s;
      }
      .table thead th.asc .fa-sort {
        transform: rotate(180deg);
      }
      .search-input {
        max-width: 300px;
      }
      .input-group-text {
        background-color: #ffffff;
        border: none;
        border-right: 1px solid #ced4da;
      }
      /* Custom Pagination Styles */
      .pagination {
        margin-top: 20px;
      }
      .pagination .page-item .page-link {
        color: #ff9800;
        border: 1px solid #ff9800;
        border-radius: 5px;
        margin-left: 5px;
        margin-right: 5px;
        transition: background-color 0.3s, color 0.3s;
      }
      .pagination .page-item .page-link:hover {
        background-color: #ff9800;
        color: #fff;
      }
      .pagination .page-item.active .page-link {
        background-color: #ff9800;
        border-color: #ff9800;
        color: #fff;
      }
      .pagination .page-item.disabled .page-link {
        color: #6c757d;
        pointer-events: none;
        cursor: not-allowed;
        background-color: #fff;
        border-color: #dee2e6;
      }
      /* Ellipsis Style */
      .pagination .page-item .ellipsis {
        color: #6c757d;
        padding: 0.5rem 0.75rem;
      }
    </style>
  </head>
  <body>
    <!-- Lấy Thông Tin Đơn Hàng Section -->
    <div class="container-fluid mt-5">
      <h2 class="text-center mb-4">Lấy Thông Tin Đơn Hàng Theo Tháng và Năm</h2>
      <!-- Bộ Lọc Thời Gian và Các Bộ Lọc Bổ Sung -->
      <div class="card">
        <div class="card-body">
          <form id="filterForm" class="row g-3">
            <div class="col-md-3">
              <label for="monthSelect" class="form-label">Chọn Tháng</label>
              <select id="monthSelect" class="form-select">
                <option value="1">Tháng 1</option>
                <option value="2">Tháng 2</option>
                <option value="3">Tháng 3</option>
                <option value="4">Tháng 4</option>
                <option value="5">Tháng 5</option>
                <option value="6">Tháng 6</option>
                <option value="7">Tháng 7</option>
                <option value="8">Tháng 8</option>
                <option value="9">Tháng 9</option>
                <option value="10" selected>Tháng 10</option>
                <option value="11">Tháng 11</option>
                <option value="12">Tháng 12</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="yearSelect" class="form-label">Chọn Năm</label>
              <select id="yearSelect" class="form-select">
                <option value="2023">2023</option>
                <option value="2024" selected>2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="statusSelect" class="form-label"
                >Trạng Thái Đơn Hàng</label
              >
              <select id="statusSelect" class="form-select">
                <option value="">Tất cả</option>
                <option value="Đã Giao Hàng">Đã Giao Hàng</option>
                <option value="Đang Xử Lý">Đang Xử Lý</option>
                <option value="Đã Hủy">Đã Hủy</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="productSelect" class="form-label">Sản Phẩm</label>
              <select id="productSelect" class="form-select">
                <option value="">Tất cả</option>
                <option value="Vải trơn">Vải trơn</option>
                <option value="Vải kaki">Vải kaki</option>
                <option value="Xấp vải truyền thống">
                  Xấp vải truyền thống
                </option>
                <option value="Phụ kiện may mặc">Phụ kiện may mặc</option>
                <option value="Vải nội thất cao cấp">
                  Vải nội thất cao cấp
                </option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="customerSelect" class="form-label">Khách Hàng</label>
              <select id="customerSelect" class="form-select">
                <option value="">Tất cả</option>
                <option value="Nguyễn Văn A">Nguyễn Văn A</option>
                <option value="Trần Thị B">Trần Thị B</option>
                <option value="Lê Thị C">Lê Thị C</option>
                <option value="Phạm Văn D">Phạm Văn D</option>
                <option value="Hoàng Thị E">Hoàng Thị E</option>
              </select>
            </div>
            <div class="col-md-3 d-flex align-items-end">
              <button type="submit" class="btn btn-primary w-100">
                Lọc Dữ Liệu
              </button>
            </div>
            <div class="col-md-3 d-flex align-items-end">
              <!-- Export Buttons -->
              <button
                type="button"
                class="btn btn-export-excel me-2"
                id="exportExcel"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Xuất dữ liệu dưới dạng Excel"
              >
                <i class="fa fa-file-excel"></i> Xuất Excel
              </button>
              <button
                type="button"
                class="btn btn-export-pdf"
                id="exportPDF"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Xuất dữ liệu dưới dạng PDF"
              >
                <i class="fa fa-file-pdf"></i> Xuất PDF
              </button>
            </div>
            <div class="col-md-6 d-flex align-items-end">
              <!-- Biểu mẫu đặt lịch báo cáo tự động -->
              <button
                type="button"
                class="btn btn-outline-secondary w-100"
                data-bs-toggle="modal"
                data-bs-target="#scheduleReportModal"
              >
                <i class="fa fa-calendar-alt"></i> Đặt Lịch Báo Cáo Tự động
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Bảng Chi Tiết Đơn Hàng -->
      <div class="card mt-4">
        <div class="card-body">
          <h5 class="card-title">Danh Sách Đơn Hàng</h5>
          <div class="d-flex justify-content-between mb-3">
            <div class="input-group">
              <span class="input-group-text" id="search-icon">
                <i class="fa fa-search"></i>
              </span>
              <input
                type="text"
                id="searchInput"
                class="form-control search-input"
                placeholder="Tìm kiếm đơn hàng..."
                aria-label="Search"
                aria-describedby="search-icon"
              />
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-striped table-hover" id="ordersTable">
              <thead class="table-dark">
                <tr>
                  <th data-sort="orderId">
                    ID Đơn Hàng <i class="fa fa-sort"></i>
                  </th>
                  <th data-sort="customerName">
                    Tên Khách Hàng <i class="fa fa-sort"></i>
                  </th>
                  <th data-sort="orderDate">
                    Ngày Đặt <i class="fa fa-sort"></i>
                  </th>
                  <th data-sort="totalAmount">
                    Tổng Tiền <i class="fa fa-sort"></i>
                  </th>
                  <th data-sort="paymentStatus">
                    Trạng Thái Thanh Toán <i class="fa fa-sort"></i>
                  </th>
                  <th data-sort="orderStatus">
                    Trạng Thái Đơn Hàng <i class="fa fa-sort"></i>
                  </th>
                </tr>
              </thead>
              <tbody id="ordersTableBody">
                <!-- Dữ liệu đơn hàng mẫu -->
                <tr>
                  <td>1001</td>
                  <td>Nguyễn Văn A</td>
                  <td>15/10/2024</td>
                  <td>1.500.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đã Giao Hàng</td>
                </tr>
                <tr>
                  <td>1002</td>
                  <td>Trần Thị B</td>
                  <td>20/10/2024</td>
                  <td>2.300.000 VND</td>
                  <td>Chưa Thanh Toán</td>
                  <td>Đang Xử Lý</td>
                </tr>
                <tr>
                  <td>1003</td>
                  <td>Lê Thị C</td>
                  <td>25/10/2024</td>
                  <td>750.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đã Giao Hàng</td>
                </tr>
                <tr>
                  <td>1004</td>
                  <td>Phạm Văn D</td>
                  <td>28/10/2024</td>
                  <td>3.200.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đang Xử Lý</td>
                </tr>
                <tr>
                  <td>1005</td>
                  <td>Hoàng Thị E</td>
                  <td>02/11/2024</td>
                  <td>1.000.000 VND</td>
                  <td>Chưa Thanh Toán</td>
                  <td>Đã Hủy</td>
                </tr>
                <tr>
                  <td>1006</td>
                  <td>Vũ Văn F</td>
                  <td>05/11/2024</td>
                  <td>2.500.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đã Giao Hàng</td>
                </tr>
                <tr>
                  <td>1007</td>
                  <td>Đặng Thị G</td>
                  <td>10/11/2024</td>
                  <td>1.800.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đang Xử Lý</td>
                </tr>
                <tr>
                  <td>1008</td>
                  <td>Ngô Văn H</td>
                  <td>12/11/2024</td>
                  <td>950.000 VND</td>
                  <td>Chưa Thanh Toán</td>
                  <td>Đã Hủy</td>
                </tr>
                <tr>
                  <td>1009</td>
                  <td>Mai Thị I</td>
                  <td>15/11/2024</td>
                  <td>2.100.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đã Giao Hàng</td>
                </tr>
                <tr>
                  <td>1010</td>
                  <td>Trịnh Văn J</td>
                  <td>18/11/2024</td>
                  <td>3.000.000 VND</td>
                  <td>Đã Thanh Toán</td>
                  <td>Đang Xử Lý</td>
                </tr>

                <tr>
                    <td>1011</td>
                    <td>Nguyễn Thị K</td>
                    <td>20/11/2024</td>
                    <td>1.200.000 VND</td>
                    <td>Đã Thanh Toán</td>
                    <td>Đã Giao Hàng</td>
                  </tr>
                  
                <!-- Thêm nhiều đơn hàng mẫu hơn để kiểm tra phân trang -->
                <!-- Bạn có thể thêm nhiều hàng hơn nếu muốn -->
              </tbody>
            </table>
          </div>
          <!-- Phân Trang -->
          <nav>
            <ul class="pagination justify-content-end" id="pagination">
              <!-- Các trang sẽ được chèn vào đây -->
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Modal Đặt Lịch Báo Cáo Tự động -->
    <div
      class="modal fade"
      id="scheduleReportModal"
      tabindex="-1"
      aria-labelledby="scheduleReportModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="scheduleReportModalLabel">
              Đặt Lịch Báo Cáo Tự động
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="scheduleReportForm">
              <div class="mb-3">
                <label for="reportFrequency" class="form-label">
                  Tần Suất Báo Cáo
                </label>
                <select id="reportFrequency" class="form-select" required>
                  <option value="">Chọn tần suất</option>
                  <option value="monthly">Hàng Tháng</option>
                  <option value="yearly">Hàng Năm</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="reportEmail" class="form-label">
                  Địa Chỉ Email Nhận Báo Cáo
                </label>
                <input
                  type="email"
                  class="form-control"
                  id="reportEmail"
                  placeholder="user@example.com"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">Đặt Lịch</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS và các thư viện phụ trợ -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- SheetJS để xuất Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- jsPDF để xuất PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts -->
    <script>
      $(document).ready(function () {
        // Initialize Tooltip
        var tooltipTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="tooltip"]')
        );
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // Variables
        let orders = [];
        let filteredOrders = [];
        let currentPage = 1;
        const rowsPerPage = 5;
        let currentSort = { column: null, order: "asc" };

        // Load Orders from Table
        function loadOrders() {
          orders = [];
          $("#ordersTableBody tr").each(function () {
            const row = $(this);
            const order = {
              orderId: row.find("td:eq(0)").text(),
              customerName: row.find("td:eq(1)").text(),
              orderDate: row.find("td:eq(2)").text(),
              totalAmount: row.find("td:eq(3)").text(),
              paymentStatus: row.find("td:eq(4)").text(),
              orderStatus: row.find("td:eq(5)").text(),
            };
            orders.push(order);
          });
          filteredOrders = orders.slice();
        }

        // Render Orders to Table
        function renderTable() {
          $("#ordersTableBody").empty();
          const start = (currentPage - 1) * rowsPerPage;
          const end = start + rowsPerPage;
          const paginatedOrders = filteredOrders.slice(start, end);
          paginatedOrders.forEach((order) => {
            const row = `<tr>
              <td>${order.orderId}</td>
              <td>${order.customerName}</td>
              <td>${order.orderDate}</td>
              <td>${order.totalAmount}</td>
              <td>${order.paymentStatus}</td>
              <td>${order.orderStatus}</td>
            </tr>`;
            $("#ordersTableBody").append(row);
          });
          renderPagination();
        }

        // Render Pagination
        function renderPagination() {
          $("#pagination").empty();
          const totalPages = Math.ceil(filteredOrders.length / rowsPerPage);

          if (totalPages === 0) return;

          // Previous Button
          const prevDisabled = currentPage === 1 ? "disabled" : "";
          $("#pagination").append(`
            <li class="page-item ${prevDisabled}">
              <a class="page-link" href="#" aria-label="Previous">
                <i class="fa fa-angle-left"></i>
              </a>
            </li>
          `);

          // Displaying Ellipsis and Page Numbers
          let startPage = 1;
          let endPage = totalPages;

          if (totalPages > 5) {
            if (currentPage <= 3) {
              startPage = 1;
              endPage = 5;
            } else if (currentPage + 2 >= totalPages) {
              startPage = totalPages - 4;
              endPage = totalPages;
            } else {
              startPage = currentPage - 2;
              endPage = currentPage + 2;
            }
          }

          if (startPage > 1) {
            $("#pagination").append(`
              <li class="page-item">
                <a class="page-link" href="#">1</a>
              </li>
              <li class="page-item disabled">
                <span class="page-link">...</span>
              </li>
            `);
          }

          for (let i = startPage; i <= endPage; i++) {
            const activeClass = i === currentPage ? "active" : "";
            $("#pagination").append(`
              <li class="page-item ${activeClass}">
                <a class="page-link" href="#">${i}</a>
              </li>
            `);
          }

          if (endPage < totalPages) {
            $("#pagination").append(`
              <li class="page-item disabled">
                <span class="page-link">...</span>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">${totalPages}</a>
              </li>
            `);
          }

          // Next Button
          const nextDisabled = currentPage === totalPages ? "disabled" : "";
          $("#pagination").append(`
            <li class="page-item ${nextDisabled}">
              <a class="page-link" href="#" aria-label="Next">
                <i class="fa fa-angle-right"></i>
              </a>
            </li>
          `);
        }

        // Handle Pagination Click
        $("#pagination").on("click", ".page-link", function (e) {
          e.preventDefault();
          const parentLi = $(this).parent();

          if (parentLi.hasClass("disabled") || parentLi.hasClass("active")) {
            return;
          }

          const text = $(this).text();
          const ariaLabel = $(this).attr("aria-label");

          if (ariaLabel === "Previous") {
            if (currentPage > 1) currentPage--;
          } else if (ariaLabel === "Next") {
            const totalPages = Math.ceil(filteredOrders.length / rowsPerPage);
            if (currentPage < totalPages) currentPage++;
          } else {
            const selectedPage = parseInt(text);
            if (!isNaN(selectedPage)) {
              currentPage = selectedPage;
            }
          }

          renderTable();
        });

        // Handle Filter Form Submission
        $("#filterForm").submit(function (e) {
          e.preventDefault();
          applyFilters();
          currentPage = 1;
          renderTable();
        });

        // Apply Filters
        function applyFilters() {
          const month = $("#monthSelect").val();
          const year = $("#yearSelect").val();
          const status = $("#statusSelect").val();
          const product = $("#productSelect").val();
          const customer = $("#customerSelect").val();
          const searchQuery = $("#searchInput").val().toLowerCase();

          filteredOrders = orders.filter((order) => {
            // Filter by Month and Year
            const [day, monthOrder, yearOrder] = order.orderDate
              .split("/")
              .map(Number);
            if (month && monthOrder !== parseInt(month)) return false;
            if (year && yearOrder !== parseInt(year)) return false;

            // Filter by Status
            if (status && order.orderStatus !== status) return false;

            // Filter by Customer
            if (customer && order.customerName !== customer) return false;

            // Search Filter
            if (
              searchQuery &&
              !(
                order.orderId.toLowerCase().includes(searchQuery) ||
                order.customerName.toLowerCase().includes(searchQuery) ||
                order.orderDate.toLowerCase().includes(searchQuery) ||
                order.totalAmount.toLowerCase().includes(searchQuery) ||
                order.paymentStatus.toLowerCase().includes(searchQuery) ||
                order.orderStatus.toLowerCase().includes(searchQuery)
              )
            )
              return false;

            return true;
          });
        }

        // Handle Search Input
        $("#searchInput").on("input", function () {
          applyFilters();
          currentPage = 1;
          renderTable();
        });

        // Handle Sorting
        $("th").click(function () {
          const sortColumn = $(this).data("sort");
          if (sortColumn) {
            if (currentSort.column === sortColumn) {
              currentSort.order = currentSort.order === "asc" ? "desc" : "asc";
            } else {
              currentSort.column = sortColumn;
              currentSort.order = "asc";
            }
            sortOrders();
            renderTable();
            updateSortIcons();
          }
        });

        // Sort Orders
        function sortOrders() {
          filteredOrders.sort((a, b) => {
            let valA = a[currentSort.column];
            let valB = b[currentSort.column];

            // Convert values for proper sorting
            if (currentSort.column === "orderId") {
              valA = parseInt(valA);
              valB = parseInt(valB);
            } else if (currentSort.column === "orderDate") {
              valA = new Date(valA.split("/").reverse().join("-"));
              valB = new Date(valB.split("/").reverse().join("-"));
            } else if (currentSort.column === "totalAmount") {
              valA = parseInt(valA.replace(/\./g, "").replace(" VND", ""));
              valB = parseInt(valB.replace(/\./g, "").replace(" VND", ""));
            } else {
              valA = valA.toLowerCase();
              valB = valB.toLowerCase();
            }

            if (valA < valB) return currentSort.order === "asc" ? -1 : 1;
            if (valA > valB) return currentSort.order === "asc" ? 1 : -1;
            return 0;
          });
        }

        // Update Sort Icons
        function updateSortIcons() {
          $("th").removeClass("asc desc");
          $("th .fa-sort").removeClass("fa-sort-up fa-sort-down");

          if (currentSort.column) {
            const currentTh = $(`th[data-sort="${currentSort.column}"]`);
            currentTh.addClass(currentSort.order);
            const sortIcon = currentTh.find(".fa-sort");
            if (currentSort.order === "asc") {
              sortIcon.removeClass("fa-sort").addClass("fa-sort-up");
            } else {
              sortIcon.removeClass("fa-sort").addClass("fa-sort-down");
            }
          }
        }

        // Export to Excel
        $("#exportExcel").click(function () {
          /* Get the orders to export */
          const exportData = filteredOrders.map((order) => ({
            "ID Đơn Hàng": order.orderId,
            "Tên Khách Hàng": order.customerName,
            "Ngày Đặt": order.orderDate,
            "Tổng Tiền": order.totalAmount,
            "Trạng Thái Thanh Toán": order.paymentStatus,
            "Trạng Thái Đơn Hàng": order.orderStatus,
          }));

          /* Create a worksheet */
          const worksheet = XLSX.utils.json_to_sheet(exportData);

          /* Create a new workbook and append the worksheet */
          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, "Đơn Hàng");

          /* Export to Excel */
          XLSX.writeFile(workbook, "Don_Hang.xlsx");
        });

        // Export to PDF
        $("#exportPDF").click(function () {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          /* Title */
          doc.text("Danh Sách Đơn Hàng", 14, 16);

          /* Define the columns and rows */
          const columns = [
            "ID Đơn Hàng",
            "Tên Khách Hàng",
            "Ngày Đặt",
            "Tổng Tiền",
            "Trạng Thái Thanh Toán",
            "Trạng Thái Đơn Hàng",
          ];
          const rows = filteredOrders.map((order) => [
            order.orderId,
            order.customerName,
            order.orderDate,
            order.totalAmount,
            order.paymentStatus,
            order.orderStatus,
          ]);

          /* Add AutoTable */
          doc.autoTable({
            startY: 20,
            head: [columns],
            body: rows,
            styles: { fontSize: 8 },
            headStyles: { fillColor: [33, 150, 243] },
          });

          /* Save the PDF */
          doc.save("Don_Hang.pdf");
        });

        // Handle Schedule Report Form Submission
        $("#scheduleReportForm").submit(function (e) {
          e.preventDefault();
          const frequency = $("#reportFrequency").val();
          const email = $("#reportEmail").val();

          if (!frequency || !email) {
            alert("Vui lòng điền đầy đủ thông tin.");
            return;
          }

          // Here you can handle the form submission, e.g., send data to the server
          alert(
            `Đã đặt lịch báo cáo tự động với tần suất ${
              frequency === "monthly" ? "Hàng Tháng" : "Hàng Năm"
            }.\nEmail: ${email}`
          );

          // Close the modal
          $("#scheduleReportModal").modal("hide");

          // Reset the form
          $("#scheduleReportForm")[0].reset();
        });

        // Initial Load
        loadOrders();
        renderTable();
      });
    </script>
  </body>
</html>
